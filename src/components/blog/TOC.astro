---
import type { Post } from "~/types";
import { Icon } from "astro-icon/components";
import { getEntry, render } from "astro:content";
interface Props {
    id:string;
}
const { id } = Astro.props;
const entry = await getEntry('post', id)
if (!entry) {
    throw new Error('Could not find blog post')
}
const {Content, headings, remarkPluginFrontmatter} = await render(entry);
const toc = headings.map((h,i) => {
    return {depth:h.depth, title:h.text, link:h.slug}
})
---
{headings[0] && (
    <h2>目次</h2>
<div tabindex="0" class="collapse collapse-plus bg-teal-50/50 dark:bg-gray-900 rounded-xl mx-auto">
    <div class="collapse-title">
        <p></p>
    </div>
    <input type="checkbox" checked={true} />
   
    <div class="collapse-content rounded-2xl p-4">
        <ul class="timeline timeline vertical">
            {
                toc && (
                    toc.map((t)=>(
                        <>
                        {!(t.title === 'Footnotes') && (
                            <a href={`#${t.link}`}>
                                {(t.depth==2) ? (
                                    <div>
                                    <li class="my-0 py-2 text-sm text-muted underline-none hover:underline hover:text-blue-400 list-row flex items-center">
                                        <div class="timeline-middle"><Icon name="tabler:brand-tinder-filled" class="text-orange-400 size-4"/></div>
                                        <div class="timeline-end timeline-box">{t.title}</div>
                                    </li>
                                ):(
                                    <li class="my-0 py-0.5 text-xs pl-5 text-muted underline-none hover:underline hover:text-blue-400 list-row flex items-center ">
                                            {t.title}
                                    </li>
                                )}
                            </a>
                        )}
                        </>
                    )
            ))}
        </ul>
    </div>
</div>
) }
